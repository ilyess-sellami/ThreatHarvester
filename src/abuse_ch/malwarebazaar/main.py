import json
from .indicators import fetch_recent
from src.abuse_ch.config import MALWAREBAZAAR_OUTPUT_FILE

def fetch_AbuseCH_MalwareBazaar_IOCs():

    print("[*] Fetching recent MalwareBazaar samples...")
    iocs = fetch_recent()

    with open(MALWAREBAZAAR_OUTPUT_FILE, "w", encoding="utf-8") as f:
        json.dump(iocs, f, indent=2, ensure_ascii=False)

    print(f"[*] Saved {len(iocs)} IOCs to {MALWAREBAZAAR_OUTPUT_FILE}")

